<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.333">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Description of the module</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Notebook_files/libs/clipboard/clipboard.min.js"></script>
<script src="Notebook_files/libs/quarto-html/quarto.js"></script>
<script src="Notebook_files/libs/quarto-html/popper.min.js"></script>
<script src="Notebook_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Notebook_files/libs/quarto-html/anchor.min.js"></script>
<link href="Notebook_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Notebook_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Notebook_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Notebook_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Notebook_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Description of the module</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>If you run a virtual envirement, you can install the requirements with the following command</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install -r requirements.txt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s load the <a href="./pyprettyplot/">library</a> that contain some useful setup and function, and set the style of the plot followin what is described in the <a href="../IllustratorsStyles/README.md">style</a> section. In summary it will plot (all scaled by ×2 for notebook display): 1. Axis with linewidth of 0.5 pt with color #2E3440 2. Tick with linewidth of 0.5 pt with color #2E3440, and length of 2pt 3. No top and right spines 4. Tick labels using Decima 7pt 5. Axis title labels using Aktiv Grotesk Condensed Regular 8pt 6. Cycling colorpalette using the Nord theme #356BA0, #D18F98, #499E4B, #7181A3, #844A84, #7181A3, #BC394C</p>
<p>*Note that pandas, numpy, and plotly are already loaded</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.offline <span class="im">import</span> download_plotlyjs, init_notebook_mode, plot, iplot</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>init_notebook_mode(connected<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyprettyplot <span class="im">import</span> <span class="op">*</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>pio.renderers.default<span class="op">=</span><span class="st">'iframe_connected'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        </script>
        <script type="module">import "https://cdn.plot.ly/plotly-3.0.0.min"</script>
        
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pio.renderers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Renderers configuration
-----------------------
    Default renderer: 'iframe_connected'
    Available renderers:
        ['plotly_mimetype', 'jupyterlab', 'nteract', 'vscode',
         'notebook', 'notebook_connected', 'kaggle', 'azure', 'colab',
         'cocalc', 'databricks', 'json', 'png', 'jpeg', 'jpg', 'svg',
         'pdf', 'browser', 'firefox', 'chrome', 'chromium', 'iframe',
         'iframe_connected', 'sphinx_gallery', 'sphinx_gallery_png']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> []</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">500</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ii <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span><span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>np.cos(x<span class="op">*</span>ii <span class="op">+</span> np.pi<span class="op">*</span>ii), mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="ss">f'Line </span><span class="sc">{</span>ii<span class="sc">}</span><span class="ss">'</span>)]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>fig.add_traces(tr)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>fig.add_vline(x<span class="op">=</span><span class="dv">0</span>, line_dash<span class="op">=</span><span class="st">'dash'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(title <span class="op">=</span> <span class="st">'x label'</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(title <span class="op">=</span> <span class="st">'y label'</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title <span class="op">=</span> <span class="st">'Here is a title'</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_4.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<section id="complete-example-in-the-wild" class="level1">
<h1>Complete Example in the Wild</h1>
<p>Although this example will use the python module based on the plotly graphic display, the tips that will be discussed can be applied for any ploting software or library.</p>
<p>This example is based on dataset that are published in <a href="https://pubs.aip.org/aip/app/article/10/1/016104/3330155">Shandilya et al “All-optical azimuthal trapping of dissipative Kerr multi-solitons for relative noise suppression” APL Photonics 10, 016104 (2025)</a></p>
<p>Let’s first load the data into a pandas dataframe</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_KIS <span class="op">=</span> pd.read_csv(<span class="st">'./ExampleDataSet/Spectrum_EXP_RW850G600_KIS_2DKS.csv'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df_noKIS <span class="op">=</span> pd.read_csv(<span class="st">'./ExampleDataSet/Spectrum_EXP_RW850G600_noKIS_2DKS.csv'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>df_KISsim <span class="op">=</span> pd.read_csv(<span class="st">'./ExampleDataSet/Sepctrum_SIM_2DKS_KIS.csv'</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>df_noKISsim <span class="op">=</span> pd.read_csv(<span class="st">'./ExampleDataSet/Sepctrum_SIM_2DKS_noKIS.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now what is important is to <strong>only</strong> display what we want in the final figure. It can of course be trimmed in Adobe Illustraotr (as explained here), but it will end up saving you time doing it now. Hence we will mask the dataset to only display what we want:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>noise_floor <span class="op">=</span> <span class="op">-</span><span class="dv">78</span> <span class="co">#dBm</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>mask_mu <span class="op">=</span> <span class="kw">lambda</span> x: np.logical_and(x.mu<span class="op">&gt;-</span><span class="dv">104</span>, x.mu<span class="op">&lt;</span><span class="dv">123</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>mask_S <span class="op">=</span> <span class="kw">lambda</span> x: x.S<span class="op">&lt;</span>noise_floor</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>df_KIS  <span class="op">=</span> df_KIS[mask_mu(df_KIS)]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>df_noKIS <span class="op">=</span> df_noKIS[mask_mu(df_noKIS)]</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>df_KISsim <span class="op">=</span> df_KISsim[mask_mu(df_KISsim)]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>df_noKISsim <span class="op">=</span> df_noKISsim[mask_mu(df_noKISsim)]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>df_KIS.S[mask_S(df_KIS)] <span class="op">=</span> noise_floor</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>df_noKIS.S[mask_S(df_noKIS)] <span class="op">=</span> noise_floor</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>df_KISsim.S[mask_S(df_KISsim)] <span class="op">=</span> noise_floor</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>df_noKISsim.S[mask_S(df_noKISsim)] <span class="op">=</span> noise_floor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cool, let’s plot it now</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fig_firstshot <span class="op">=</span> go.Figure()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> [go.Scatter(x<span class="op">=</span>df_noKIS.mu, y<span class="op">=</span>df_noKIS.S, name<span class="op">=</span><span class="st">"noKIS exp"</span>)]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_noKISsim.mu, y<span class="op">=</span>df_noKISsim.S, name<span class="op">=</span><span class="st">"noKIS sim"</span>)]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KIS.mu, y<span class="op">=</span>df_KIS.S, name<span class="op">=</span><span class="st">"KIS exp"</span>)]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KISsim.mu, y<span class="op">=</span>df_KISsim.S, name<span class="op">=</span><span class="st">"KIS sim"</span>)]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>fig_firstshot.add_traces(tr)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>fig_firstshot.update_xaxes(title<span class="op">=</span><span class="st">'Mode Number µ'</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>fig_firstshot.update_yaxes(title<span class="op">=</span><span class="st">"Power [dBm]"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>fig_firstshot.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_7.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Clearly, this is not a pretty plot. Let’s make it pretty. As explain in the <a href="../README.md#basic-graphic-dezzsign">Basic Graphic Design section</a>, we need to follow <em>clarity</em>, <em>simplicity</em>, and <em>consistency</em>. 1. <strong>Clarity</strong>: The spectra overalaping make the plot hard to read. We can offset them from one another to make them more readable 2. <strong>Simplicity</strong>: The plot is already simple, but we could remove the grid and the legend to make it even simpler. 3. <strong>Consistency</strong>: Since we have simulation and experiment, and unsynchronized and synchronizated, we should make sure that they easily identifiable</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>offset <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>clr_KISsim <span class="op">=</span> <span class="st">"#283947"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>clr_KISexp <span class="op">=</span> <span class="st">"#366CA0"</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>clr_noKISsim <span class="op">=</span> <span class="st">"#884C5A"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>clr_noKISexp <span class="op">=</span> <span class="st">"#D18E97"</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> [go.Scatter(x<span class="op">=</span>df_noKIS.mu, y<span class="op">=</span>df_noKIS.S, line_color<span class="op">=</span>clr_noKISexp, name<span class="op">=</span><span class="st">"noKIS exp"</span>)]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_noKISsim.mu, y<span class="op">=</span>df_noKISsim.S, line_color<span class="op">=</span>clr_noKISsim, name<span class="op">=</span><span class="st">"noKIS sim"</span>)]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KIS.mu, y<span class="op">=</span>df_KIS.S <span class="op">-</span> offset, line_color<span class="op">=</span>clr_KISexp, name<span class="op">=</span><span class="st">"KIS exp"</span>)]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KISsim.mu, y<span class="op">=</span>df_KISsim.S <span class="op">-</span> offset, line_color<span class="op">=</span>clr_KISsim, name<span class="op">=</span><span class="st">"KIS sim"</span>)]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>fig.add_traces(tr)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(title<span class="op">=</span><span class="st">'Mode Number µ'</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(title<span class="op">=</span><span class="st">"Power [dB]"</span>, dtick<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_8.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>One may say that it is actally less clear now, isn’t it? Mostly becasue the two spectra overlap make it not very clear to see things.</p>
<p>One trick that is quite conveninet is to create a white background behind the spectra. This will make the spectra more readable. One may do it in Illustrator (as explained), or directly in the plot:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>offset <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>clr_KISsim <span class="op">=</span> <span class="st">"#283947"</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>clr_KISexp <span class="op">=</span> <span class="st">"#366CA0"</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>clr_noKISsim <span class="op">=</span> <span class="st">"#884C5A"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>clr_noKISexp <span class="op">=</span> <span class="st">"#D18E97"</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> [go.Scatter(x<span class="op">=</span>df_noKIS.mu, y<span class="op">=</span>df_noKIS.S, line_color<span class="op">=</span>clr_noKISexp, name<span class="op">=</span><span class="st">"noKIS exp"</span>)]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">## adding the while blocking region</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_noKISsim.mu, y<span class="op">=</span>df_noKISsim.S, line_color<span class="op">=</span><span class="st">"white"</span>, line_width <span class="op">=</span> <span class="dv">4</span>, name<span class="op">=</span><span class="st">"Blocking"</span>)]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_noKISsim.mu, y<span class="op">=</span>df_noKISsim.S, line_color<span class="op">=</span>clr_noKISsim, name<span class="op">=</span><span class="st">"noKIS sim"</span>)]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">## adding the while blocking region</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KIS.mu, y<span class="op">=</span>df_KIS.S <span class="op">-</span> offset <span class="op">+</span> <span class="dv">2</span>, line_color<span class="op">=</span><span class="st">"white"</span>, line_width <span class="op">=</span> <span class="dv">4</span>, name<span class="op">=</span><span class="st">"Blocking"</span>)]</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KIS.mu, y<span class="op">=</span>df_KIS.S <span class="op">-</span> offset, line_color<span class="op">=</span>clr_KISexp, name<span class="op">=</span><span class="st">"KIS exp"</span>)]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">## adding the while blocking region</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KISsim.mu, y<span class="op">=</span>df_KISsim.S <span class="op">-</span> offset, line_color<span class="op">=</span><span class="st">"white"</span>, line_width <span class="op">=</span> <span class="dv">4</span>, name<span class="op">=</span><span class="st">"Blocking"</span>)]</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KISsim.mu, y<span class="op">=</span>df_KISsim.S <span class="op">-</span> offset, line_color<span class="op">=</span>clr_KISsim, name<span class="op">=</span><span class="st">"KIS sim"</span>)]</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>fig.add_traces(tr)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(title<span class="op">=</span><span class="st">'Mode Number µ'</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(title<span class="op">=</span><span class="st">'Power [dBm]'</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_9.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Looking better? We can still improve, in particuarly the <strong>clarity</strong>.</p>
<p>All publication figure (or subplots) must convey <strong>a single message</strong>, which must be the goal of the design. In the example chosen, the message is that there is a change of the spectrum patter between the synchronizaed and unsynchronized case. When the spectra were overlapping it was pretty obvious. However, offseting them for clarity had weaken the goal of the plot. We must fix this issue, since <strong>a pretty figure is always worse than a clear figure</strong></p>
<p>A solution is to introduce an offset which makes the change of pattern more obvious.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>offset <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>clr_KISsim <span class="op">=</span> <span class="st">"#283947"</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>clr_KISexp <span class="op">=</span> <span class="st">"#366CA0"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>clr_noKISsim <span class="op">=</span> <span class="st">"#884C5A"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>clr_noKISexp <span class="op">=</span> <span class="st">"#D18E97"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> [go.Scatter(x<span class="op">=</span>df_noKIS.mu, y<span class="op">=</span>df_noKIS.S, line_color<span class="op">=</span>clr_noKISexp, name<span class="op">=</span><span class="st">"noKIS exp"</span>, legendgroup <span class="op">=</span> <span class="st">"noKIS"</span>)]</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">## adding the while blocking region</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_noKISsim.mu, y<span class="op">=</span>df_noKISsim.S, line_color<span class="op">=</span><span class="st">"white"</span>, line_width <span class="op">=</span> <span class="dv">4</span>, name<span class="op">=</span><span class="st">"Blocking"</span>, showlegend <span class="op">=</span> <span class="va">False</span>, legendgroup <span class="op">=</span> <span class="st">"noKIS"</span>)]</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_noKISsim.mu, y<span class="op">=</span>df_noKISsim.S, line_color<span class="op">=</span>clr_noKISsim, name<span class="op">=</span><span class="st">"noKIS sim"</span>, legendgroup <span class="op">=</span> <span class="st">"noKIS"</span>)]</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">## adding the while blocking region</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KIS.mu, y<span class="op">=</span>df_KIS.S <span class="op">-</span> offset <span class="op">+</span> <span class="dv">2</span>, line_color<span class="op">=</span><span class="st">"white"</span>, line_width <span class="op">=</span> <span class="dv">4</span>, name<span class="op">=</span><span class="st">"Blocking"</span>, showlegend <span class="op">=</span> <span class="va">False</span>, legendgroup <span class="op">=</span> <span class="st">"KIS"</span>)]</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KIS.mu, y<span class="op">=</span>df_KIS.S <span class="op">-</span> offset, line_color<span class="op">=</span>clr_KISexp, name<span class="op">=</span><span class="st">"KIS exp"</span>, legendgroup <span class="op">=</span> <span class="st">"KIS"</span>)]</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">## adding the while blocking region</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KISsim.mu, y<span class="op">=</span>df_KISsim.S <span class="op">-</span> offset, line_color<span class="op">=</span><span class="st">"white"</span>, line_width <span class="op">=</span> <span class="dv">4</span>, name<span class="op">=</span><span class="st">"Blocking"</span>, showlegend <span class="op">=</span> <span class="va">False</span>, legendgroup <span class="op">=</span> <span class="st">"KIS"</span>)]</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>tr <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KISsim.mu, y<span class="op">=</span>df_KISsim.S <span class="op">-</span> offset, line_color<span class="op">=</span>clr_KISsim, name<span class="op">=</span><span class="st">"KIS sim"</span>, legendgroup <span class="op">=</span> <span class="st">"KIS"</span>)]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>fig.add_traces(tr)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(title<span class="op">=</span><span class="st">'Mode Number µ'</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(title<span class="op">=</span><span class="st">'Power [dB]'</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>fig.update_layout(legend <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="fl">1.02</span>,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">## Adding the inset</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>mz <span class="op">=</span> <span class="kw">lambda</span> x: np.logical_and(x.mu<span class="op">&gt;=</span><span class="dv">45</span>, x.mu<span class="op">&lt;=</span><span class="dv">60</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>par <span class="op">=</span> <span class="bu">dict</span>(showlegend <span class="op">=</span> <span class="va">False</span>, xaxis <span class="op">=</span> <span class="st">"x2"</span>, yaxis <span class="op">=</span> <span class="st">"y2"</span>, mode<span class="op">=</span> <span class="st">'lines'</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>trzoom <span class="op">=</span> [go.Scatter(x<span class="op">=</span>df_noKIS[mz(df_noKIS)].mu, y<span class="op">=</span>df_noKIS[mz(df_noKIS)].S, line_color<span class="op">=</span>clr_noKISexp, legendgroup <span class="op">=</span> <span class="st">"noKIS"</span>, <span class="op">**</span>par)]</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co">## adding the while blocking region</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>trzoom <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_noKISsim[mz(df_noKISsim)].mu, y<span class="op">=</span>df_noKISsim[mz(df_noKISsim)].S, line_color<span class="op">=</span><span class="st">"white"</span>, line_width <span class="op">=</span> <span class="dv">4</span>, legendgroup <span class="op">=</span> <span class="st">"noKIS"</span>, <span class="op">**</span>par)]</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>trzoom <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_noKISsim[mz(df_noKISsim)].mu, y<span class="op">=</span>df_noKISsim[mz(df_noKISsim)].S, line_color<span class="op">=</span>clr_noKISsim, legendgroup <span class="op">=</span> <span class="st">"noKIS"</span>, <span class="op">**</span>par)]</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co">## adding the while blocking region</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>trzoom <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KIS[mz(df_KIS)].mu, y<span class="op">=</span>df_KIS[mz(df_KIS)].S <span class="op">-</span> <span class="dv">10</span> <span class="op">+</span> <span class="dv">2</span>, line_color<span class="op">=</span><span class="st">"white"</span>, line_width <span class="op">=</span> <span class="dv">4</span>, legendgroup <span class="op">=</span> <span class="st">"KIS"</span>, <span class="op">**</span>par)]</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>trzoom <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KIS[mz(df_KIS)].mu, y<span class="op">=</span>df_KIS[mz(df_KIS)].S <span class="op">-</span> <span class="dv">10</span>, line_color<span class="op">=</span>clr_KISexp, legendgroup <span class="op">=</span> <span class="st">"KIS"</span>, <span class="op">**</span>par)]</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="co">## adding the while blocking region</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>trzoom <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KISsim[mz(df_KISsim)].mu, y<span class="op">=</span>df_KISsim[mz(df_KISsim)].S <span class="op">-</span> <span class="dv">10</span>, line_color<span class="op">=</span><span class="st">"white"</span>, line_width <span class="op">=</span> <span class="dv">4</span>, legendgroup <span class="op">=</span> <span class="st">"KIS"</span>, <span class="op">**</span>par)]</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>trzoom <span class="op">+=</span> [go.Scatter(x<span class="op">=</span>df_KISsim[mz(df_KISsim)].mu, y<span class="op">=</span>df_KISsim[mz(df_KISsim)].S <span class="op">-</span> <span class="dv">10</span>, line_color<span class="op">=</span>clr_KISsim, legendgroup <span class="op">=</span> <span class="st">"KIS"</span>, <span class="op">**</span>par)]</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>fig.add_traces(trzoom)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    xaxis2<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>        domain<span class="op">=</span>[<span class="fl">0.67</span>, <span class="fl">0.91</span>],</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>        anchor<span class="op">=</span><span class="st">'y2'</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    yaxis2<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>        domain<span class="op">=</span>[<span class="fl">0.65</span>, <span class="dv">1</span>],</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>        anchor<span class="op">=</span><span class="st">'x2'</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="co">## Display first and last figure against each other</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_13.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fig_firstshot.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_14.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Comparing them side by side, it is clear that we have improve the plot significantly.</p>
</section>
<section id="saving-the-figure" class="level1">
<h1>Saving the figure</h1>
<p>For the sake of display the figure has been scale by a <strong>factor 2</strong>, hence when saving the vector figure, the <code>scale = 0.5</code> parameter should be used. Additionally, it may be convenient to set the width and height of the figure accordingly to the final size of the figurein the publication: - 1 column: width = 250 px, height = 135 px (single subplots) [x2 since the 2 time scale for display] - 2 column: width = 524.29 px px, height = 200 px (single subplots) [x2 since the 2 time scale for display</p>
<p>This way, the font size will all be consistent with all the figure of you paper (tick= 7 pt, label title = 8 pt, legend = 6 pt, axis linewidth = 0.5pt, plot line = 0.75 pt)</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig.update_layout(width<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="fl">250.15</span>, height<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="dv">134</span>, margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">0</span>, r<span class="op">=</span><span class="dv">0</span>, t<span class="op">=</span><span class="dv">0</span>, b<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig.write_image(<span class="st">"ExamplePlot.svg"</span>, scale<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However to save in png, to get a larger resolution, it is better to use a larger scale to avoid pixelization. All the element with remains at scale</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig.write_image(<span class="st">"ExamplePlot.png"</span>, scale<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>